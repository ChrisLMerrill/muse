apply plugin: 'distribution'

version 0.1

subprojects
    {
    apply plugin: 'java'
    apply plugin: 'maven'

    version = 0.1
    group = 'org.musetest'
    //jar.baseName = rootProject.name + "-" + name         // This caused problems with the POM dependencies. Need to investigate and fix?

    repositories
        {
        mavenCentral()
        }

    //noinspection GroovyAssignabilityCheck
    dependencies
        {
        testCompile 'junit:junit:4+'
        }

    task copyTestResources(type: Copy) {
        from "${projectDir}/src/test/resources"
        into "${buildDir}/classes/test"
        }
    processTestResources.dependsOn copyTestResources

    task sourcesJar(type: Jar) {
        classifier = 'sources'
        from sourceSets.main.allSource
    }

    task javadocJar(type: Jar, dependsOn: javadoc) {
        classifier = 'javadoc'
        from javadoc.destinationDir
    }

    artifacts {
        archives sourcesJar
        archives javadocJar
    }


    }

distributions
    {
    muse
        {
        baseName = 'muse';
        contents
            {
            into 'lib'
            from { subprojects.jar.outputs }
            from { subprojects.configurations.runtime }
            duplicatesStrategy = DuplicatesStrategy.EXCLUDE
            }
        }
    }

